# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data

Unzip and load the data
```{r Processing, echo=TRUE}
unzip("activity.zip")
data <- read.csv(file = "activity.csv",
                 na.strings = "NA",
                 colClasses = c("numeric", "Date", "numeric"))
head(data)
```


## What is mean total number of steps taken per day?
```{r Histogram, echo=TRUE}
library(ggplot2)
library(plyr)

nsteps.per.day <- ddply(data, "date", summarise, 
                        total.steps = sum(steps, na.rm = TRUE))
head(nsteps.per.day)

p <- ggplot(data = nsteps.per.day) +
        geom_histogram(aes(x = total.steps), binwidth = 2000) +
        labs(x = "Total number of steps taken each day",
             y = "Count",
             title = "Histogram of the Total Number of Steps Taken Each Day")   
print(p)
```

#### Mean and median total number of steps taken per day

```{r MeanAndMedian, echo=TRUE}
mean.steps.per.day <- mean(nsteps.per.day$total.steps)
print(mean.steps.per.day)

median.steps.per.day <- median(nsteps.per.day$total.steps)
print(median.steps.per.day)
```

## What is the average daily activity pattern?

```{r TimeSeries, echo=TRUE}
ndays <- nrow(nsteps.per.day) # Total number of days

avg.nsteps.per.interval <- ddply(data, "interval", summarise, 
                                average.nsteps = sum(steps, na.rm = TRUE)/ndays)

head(avg.nsteps.per.interval)

p <- ggplot(avg.nsteps.per.interval, aes(x = interval, y = average.nsteps)) +
        geom_line() +
        labs(x = "5-minute interval",
             y = "Daily average number of steps",
             title = "Average Daily Activity Pattern")

print(p)
```
#### 5-minute interval with the maximum number of steps on daily average:

```{r MaxDAvgSteps, echo=TRUE}
avg.max.nsteps <- max(avg.nsteps.per.interval$average.nsteps)
print(avg.max.nsteps)
```


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
